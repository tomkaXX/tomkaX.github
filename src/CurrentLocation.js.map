{"version":3,"sources":["../../src/CurrentLocation.js"],"names":[],"mappings":"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","file":"CurrentLocation.js","sourcesContent":["\nimport Beacon from './Beacon.js';\n\nimport * as Loaders from './Loaders.js';\n\nexport default class CurrentLocation extends THREE.Object3D {\n\n  constructor(data) {\n    super();\n\n    this.data = data;\n\n    var currLocationEle = document.createElement(\"div\");\n\n    var currLocationTitle = document.createElement(\"span\");\n    currLocationTitle.textContent = \"Current Location\";\n    currLocationEle.appendChild(currLocationTitle);\n\n    currLocationEle.className = \"popupDisplay tweet\";\n    currLocationEle.style.top = \"0px\";\n    currLocationEle.style.left = \"0px\";\n    this.currLocationEle = currLocationEle;\n\n    canvasWrapper.appendChild(currLocationEle);\n\n    this.currLocationEle.addEventListener('click', (e) => {\n      this.onClick();\n    });\n\n    var beacon = new Beacon();\n    this.add(beacon);\n    beacon.rotation.x = -Math.PI/2;\n    beacon.position.z = -2.5;\n    this.beacon = beacon;\n    this.beacon.mesh.material.map = Loaders.Texture(\"images/current_location.png\");\n\n    var updateListener = () => {\n      this.update();\n    };\n\n    global.events.addEventListener('update', updateListener);\n\n    this.addEventListener('removed', () => {\n      this.destroy();\n      global.events.removeEventListener('update', updateListener);\n    })\n  }\n\n  onClick() {\n    // leftSide.className = \"\";\n    rightSide.className = \"\";\n    biggieSmalls.className = \"\";\n    // leftSide.scrollTop = 0;\n    rightSide.scrollTop = 0;\n    biggieSmalls.scrollTop = 0;\n\n    var cat = earth.categoryFromLatLong(this.data.lat, this.data.long);\n\n    events.dispatchEvent({type: 'changeFocus', data: {twitter: null, currentLocation: cat, current: true}});\n  }\n\n  startHover() {\n  }\n\n  stopHover() {\n  }\n\n  destroy() {\n\n  }\n\n  update() {\n    this.lookAt(new THREE.Vector3(0,0,0));\n\n    var pos3D = this.localToWorld(new THREE.Vector3(0,0,0));\n    \n    var pos = calc3Dto2D(pos3D);\n    // console.log(pos);\n    this.currLocationEle.style.left = Math.floor((pos.x+1)/2*window.innerWidth) + 'px';\n    this.currLocationEle.style.top = Math.floor(window.innerHeight-Math.floor((pos.y+1)/2*window.innerHeight)) + 'px';\n    // this.tweetEle.style.opacity\n\n    if (!this.currLocationEle.overrideOpacity) {\n      var dist = camera.position.length()/2;\n      var opacity = (dist-camera.position.distanceTo(pos3D))/dist;\n      if (opacity < 0) {\n        opacity = 0;\n        this.currLocationEle.style.display = 'none';\n      } else {\n        this.currLocationEle.style.display = 'inline-block';\n      }\n\n      if (opacity > 1) {\n        opacity = 1;\n      }\n\n      this.currLocationEle.style.opacity = opacity;\n    }\n\n    if (this.currLocationEle.style.opacity <= 0) {\n      this.currLocationEle.style.opacity = 0;\n      this.currLocationEle.style.display = 'none';\n    } else {\n      if (this.hovering) {\n        this.currLocationEle.style.display = 'inline-block';\n      }\n    }\n\n  }\n}\n"]}